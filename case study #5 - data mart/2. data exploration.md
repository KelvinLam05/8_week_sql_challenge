**1. What day of the week is used for each week_date value?**

````sql

SELECT
  DISTINCT DATE_PART('dow', week_date :: DATE) AS day_of_the_week
FROM clean_weekly_sales;

````

| day_of_the_week |
| --------------- |
| 1               |

<br/>

**2. What range of week numbers are missing from the dataset?**

````sql

SELECT *
FROM generate_series(1, 52) AS missing_week_numbers
WHERE missing_week_numbers NOT IN (SELECT week_number FROM clean_weekly_sales);

````

| missing_week_numbers |
| -------------------- |
| 1                    |
| 2                    |
| 3                    |
| 4                    |
| 5                    |
| 6                    |
| 7                    |
| 8                    |
| 9                    |
| 10                   |
| 11                   |
| 12                   |
| 37                   |
| 38                   |
| 39                   |
| 40                   |
| 41                   |
| 42                   |
| 43                   |
| 44                   |
| 45                   |
| 46                   |
| 47                   |
| 48                   |
| 49                   |
| 50                   |
| 51                   |
| 52                   |

<br/>

**3. How many total transactions were there for each year in the dataset?**

````sql

SELECT
  calendar_year,
  SUM(transactions) AS total_transactions
FROM clean_weekly_sales
GROUP BY calendar_year 
ORDER BY calendar_year ASC;

````

| calendar_year | total_transactions |
| ------------- | ------------------ |
| 2018          | 346406460          |
| 2019          | 365639285          |
| 2020          | 375813651          |

<br/>

**4. What is the total sales for each region for each month?**

````sql

SELECT
  month_number,
  region,
  SUM(sales) AS total_sales
FROM clean_weekly_sales
GROUP BY 
  month_number,
  region
ORDER BY 
  month_number ASC,
  region ASC;   
````

| month_number | region        | total_sales |
| ------------ | ------------- | ----------- |
| 3            | AFRICA        | 567767480   |
| 3            | ASIA          | 529770793   |
| 3            | CANADA        | 144634329   |
| 3            | EUROPE        | 35337093    |
| 3            | OCEANIA       | 783282888   |
| 3            | SOUTH AMERICA | 71023109    |
| 3            | USA           | 225353043   |
| 4            | AFRICA        | 1911783504  |
| 4            | ASIA          | 1804628707  |
| 4            | CANADA        | 484552594   |
| 4            | EUROPE        | 127334255   |
| 4            | OCEANIA       | 2599767620  |
| 4            | SOUTH AMERICA | 238451531   |
| 4            | USA           | 759786323   |
| 5            | AFRICA        | 1647244738  |
| 5            | ASIA          | 1526285399  |
| 5            | CANADA        | 412378365   |
| 5            | EUROPE        | 109338389   |
| 5            | OCEANIA       | 2215657304  |
| 5            | SOUTH AMERICA | 201391809   |
| 5            | USA           | 655967121   |
| 6            | AFRICA        | 1767559760  |
| 6            | ASIA          | 1619482889  |
| 6            | CANADA        | 443846698   |
| 6            | EUROPE        | 122813826   |
| 6            | OCEANIA       | 2371884744  |
| 6            | SOUTH AMERICA | 218247455   |
| 6            | USA           | 703878990   |
| 7            | AFRICA        | 1960219710  |
| 7            | ASIA          | 1768844756  |
| 7            | CANADA        | 477134947   |
| 7            | EUROPE        | 136757466   |
| 7            | OCEANIA       | 2563459400  |
| 7            | SOUTH AMERICA | 235582776   |
| 7            | USA           | 760331754   |
| 8            | AFRICA        | 1809596890  |
| 8            | ASIA          | 1663320609  |
| 8            | CANADA        | 447073019   |
| 8            | EUROPE        | 122102995   |
| 8            | OCEANIA       | 2432313652  |
| 8            | SOUTH AMERICA | 221166052   |
| 8            | USA           | 712002790   |
| 9            | AFRICA        | 276320987   |
| 9            | ASIA          | 252836807   |
| 9            | CANADA        | 69067959    |
| 9            | EUROPE        | 18877433    |
| 9            | OCEANIA       | 372465518   |
| 9            | SOUTH AMERICA | 34175583    |
| 9            | USA           | 110532368   |

<br/>

**5. What is the total count of transactions for each platform?**

````sql

SELECT
  platform,
  SUM(transactions) AS total_transactions
FROM clean_weekly_sales
GROUP BY platform
ORDER BY total_transactions DESC;

````

| platform | total_transactions |
| -------- | ------------------ |
| Retail   | 1081934227         |
| Shopify  | 5925169            |

<br/>

**6. What is the percentage of sales for Retail vs Shopify for each month?**
