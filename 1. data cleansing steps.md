SELECT
	TO_CHAR(TO_DATE(week_date, 'DD/MM/YY'), 'YYYY-MM-DD') AS week_date,
	DATE_PART('week', TO_DATE(week_date, 'DD/MM/YY')) AS week_number,
    DATE_PART('month', TO_DATE(week_date, 'DD/MM/YY')) AS month_number,
    DATE_PART('year', TO_DATE(week_date, 'DD/MM/YY')) AS calendar_year, 
	region,
    platform,
    segment,
    CASE 
    	WHEN SUBSTRING(segment, 2, 2) = '1' THEN 'Young Adults'
        WHEN SUBSTRING(segment, 2, 2) = '2' THEN 'Middle Aged'
        WHEN SUBSTRING(segment, 2, 2) = '3' 
        	OR SUBSTRING(segment, 2, 2) = '4' THEN 'Retirees' ELSE 'unknown'
    END AS age_band,
    CASE
    	WHEN LEFT(segment, 1) = 'C' THEN 'Couples'
        WHEN LEFT(segment, 1) = 'F' THEN 'Families' ELSE 'unknown' 
    END AS demographic
FROM data_mart.weekly_sales
LIMIT 10;
